' System.Web.Services.Protocols.HttpWebClientProtocol.UserAgent
' The following example demonstrates 'UserAgent' member of 'HttpWebClientProtocol' 
' class. First the default user agent is displayed. Then the user agent is modified 
' and displayed.


' The following example is a proxy class generated by the Wsdl.exe utility
' for the Math Web service. The proxy class derives from SoapHttpClientProtocol, 
' which derives from the abstract HttpWebClientProtocol class.

'<System.Web.Services.WebServiceBindingAttribute(Name:="MyMathSoap", _
'    [Namespace]:="http://tempuri.org/")>  _
'Public Class MyMath
'    Inherits System.Web.Services.Protocols.SoapHttpClientProtocol
'    
'    <System.Diagnostics.DebuggerStepThroughAttribute()>  _
'    Public Sub New()
'        MyBase.New
'        Me.Url = "http://localhost/Mymath.Vb.asmx"
'    End Sub
'    
'    <System.Diagnostics.DebuggerStepThroughAttribute(),  _
'        System.Web.Services.Protocols.SoapDocumentMethodAttribute( _
'        "http://tempuri.org/Add", _
'        Use:=System.Web.Services.Description.SoapBindingUse.Literal, _
'        ParameterStyle:= _
'        System.Web.Services.Protocols.SoapParameterStyle.Wrapped)>  _
'    Public Function Add(ByVal num1 As Integer, ByVal num2 As Integer) _
'        As Integer
'        Dim results() As Object = Me.Invoke("Add", New Object() {num1, num2})
'        Return CType(results(0),Integer)
'    End Function
'    
'    <System.Diagnostics.DebuggerStepThroughAttribute()>  _
'    Public Function BeginAdd(ByVal num1 As Integer, ByVal num2 As Integer, _
'        ByVal callback As System.AsyncCallback, ByVal asyncState As Object) _
'        As System.IAsyncResult
'        Return Me.BeginInvoke("Add", New Object() {num1, num2}, callback, _
'            asyncState)
'    End Function
'    
'    <System.Diagnostics.DebuggerStepThroughAttribute()>  _
'    Public Function EndAdd(ByVal asyncResult As System.IAsyncResult) As Integer
'        Dim results() As Object = Me.EndInvoke(asyncResult)
'        Return CType(results(0),Integer)
'    End Function
'End Class


Imports System.Net
Imports System.Web.Services.Protocols
Imports System.Web.Services

Namespace Test

Public Class MyMath : Inherits SoapHttpClientProtocol
End Class

Public Class HttpWebClientProtocolClass
   Public Shared Sub Main()
' <Snippet1>
      ' MyMath is a proxy class.
      Dim objMyMath As MyMath = new MyMath()

      ' Get the default user agent.
      Console.WriteLine("Default user agent is: " & objMyMath.UserAgent)
      objMyMath.UserAgent = "My Agent"
      Console.WriteLine("Modified user agent is: " & objMyMath.UserAgent)
' </Snippet1>
   End Sub
End Class

End Namespace
